# 00-02 Plan - Edge Function Contract Stubs

**Owner:** [JUNIOR-DEV]  
**Phase:** 0 - Architecture & Setup  
**Status:** Completed (2026-02-26)

## Scope

Create secure edge-function stubs for lead estimate trigger and offline sync interfaces, including shared auth and request validation utilities.

## Files Touched

- `supabase/functions/_shared/auth.ts`
- `supabase/functions/_shared/validation.ts`
- `supabase/functions/leads-estimate-sent/index.ts`
- `supabase/functions/sync-push/index.ts`
- `supabase/functions/sync-pull/index.ts`

## Acceptance Criteria

- Each endpoint validates HTTP method and request shape.
- UUID/date payload fields are validated before any query.
- User/profile/organization context is derived from bearer token.
- Endpoints return typed JSON with explicit error codes.
- Future logic points are marked with context-tagged TODOs for Phase 1/2 implementation.

## Security Checks

- Client payload does not control organization authorization.
- Device and lead lookups are organization-scoped.
- Missing/invalid auth returns `401` or `403` with safe error messaging.
- No hardcoded secrets in function code.
